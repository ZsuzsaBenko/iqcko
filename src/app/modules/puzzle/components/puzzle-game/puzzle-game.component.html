<app-navbar></app-navbar>
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="row">
                <div *ngIf="isFetching" class="col-12" id="game-spinner">
                    <div class="spinner-border spinner" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                </div>
                <div *ngIf="!isFetching"
                     class="col-12 col-md-10 offset-md-1 col-lg-8 offset-lg-2 puzzle-container">
                    <p *ngIf="puzzle.member !== null" class="puzzle-info">Beküldő:
                        <span>{{ puzzle.member.username }}</span>
                        <span id="date"> {{ puzzle.submissionTime | date:'yyyy. MM. dd.' }}</span>
                    </p>
                    <h1>{{ puzzle.title }}</h1>
                    <p class="puzzle-info">Instrukció:
                        <span class="preserve-newline">{{ puzzle.instruction }}</span>
                    </p>
                    <div class="puzzle-item">
                        <p *ngIf="categoryEnum.PICTURE_PUZZLE !== puzzle.category"
                           class="preserve-newline">{{ puzzle.puzzleItem }}</p>
                        <img *ngIf="categoryEnum.PICTURE_PUZZLE === puzzle.category"
                             src="https://firebasestorage.googleapis.com/v0/b/puzzles-a6dd7.appspot.com/o/{{ puzzle.puzzleItem }}"
                             alt="puzzle image">
                    </div>
                    <p class="rating">
                        <app-stars [puzzle]="puzzle"></app-stars>
                    </p>
                    <div class="answer-form" *ngIf="!isSolved">
                        <form (ngSubmit)="checkAnswer(f)" #f="ngForm">
                            <label for="answer">Válasz: </label>
                            <input type="text"
                                   id="answer"
                                   name="answer"
                                   ngModel>
                            <div class="answer-btn-div">
                                <button id="cancel-button"
                                        type="button"
                                        (click)="cancel()">Mégse
                                </button>
                                <button id="check-button"
                                        type="submit">Helyes?
                                </button>
                            </div>
                        </form>
                        <p *ngIf="isIncorrect"
                           id="incorrect-message">Nem ez a helyes megoldás. Próbálkozz tovább!
                        </p>
                    </div>
                    <div *ngIf="isSolved" class="rating-box" >
                        <h3>Kiváló megfejtés!</h3>
                        <p>Értékeld a rejtvényt, és küldd be a megoldásod!</p>
                        <div class="rating-stars">
                            <ngb-rating [(rate)]="rating" [max]="5">
                                <ng-template let-fill="fill">
                                    <span class="star" [class.filled]="fill === 100">&#9733;</span>
                                </ng-template>
                            </ngb-rating>
                        </div>
                        <button type="button" (click)="sendSolution()">Küldés</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
